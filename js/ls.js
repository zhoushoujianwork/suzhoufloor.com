function generateVisitId(){for(var e="",o=0;o<4;o++)e+=Math.floor(65536*Math.random()).toString(16);return e}function getQueryValueByKey(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=o.exec(window.location.href);return null==n?"":n[1]}function validateLeadKey(e){return e.match(/^[a-z0-9]{32}$/i)}function encodeForUrl(e){return encodeURIComponent(e)}function loadImageWithTracking(e){var o="k="+encodeForUrl(e),n="h="+encodeForUrl(window.location.href.split("//")[1].split("/")[0]),t="p="+encodeForUrl(window.location.pathname),a="q="+encodeForUrl(window.location.search),r="t="+encodeForUrl(window.location.hash),c="s="+encodeForUrl(""+_lsa.a),i="v="+encodeForUrl(docCookies.getItem("__lsv")),l="r="+encodeForUrl(document.referrer),s=document.createElement("img");s.src=urlApiRoot+"hit?"+o+"&"+n+"&"+t+"&"+a+"&"+r+"&"+c+"&"+i+"&"+l}function loadImageForIdentification(e,o){var n=document.createElement("img");n.src=urlApiRoot+"id/"+encodeForUrl(e)+"/"+encodeForUrl(o)}function hit(e){loadImageWithTracking(e),docCookies.setItem("__lsk",e,31536e3,"/",null,null)}function lsaCaptureLead(e,o){docCookies.getItem("__lscapt")!==!1&&window.location.search?JSONP(urlApiRoot+"capture.json?s="+encodeForUrl(_lsa.a)+"&h="+encodeForUrl(window.location.href.split("//")[1].split("/")[0])+"&k="+encodeForUrl(e)+"&r="+encodeForUrl(window.location.href),function(n){n.e&&null!==n.k&&validateLeadKey(n.k)&&(e?docCookies.setItem("__lsk",n.k,31536e3,"/",null,null):hit(n.k),e=n.k),n.e===!0&&docCookies.setItem("__lscapt",!0,21600,"/",null,null),"function"==typeof o&&o(e)}):"function"==typeof o&&o(e)}function trackLeadScore(){docCookies.getItem("__lsv")||docCookies.setItem("__lsv",generateVisitId(),21600,"/",null,null);var e=getQueryValueByKey("__lsk"),o=docCookies.getItem("__lsk"),n=null;e&&validateLeadKey(e)?(o&&validateLeadKey(o)&&o!==e&&loadImageForIdentification(o,e),n=e,hit(e)):o&&validateLeadKey(o)&&(n=o,hit(o)),lsaCaptureLead(n,function(e){e||docCookies.getItem("__lsanno")?processLsaMarketingCooke(e):JSONP(urlApiRoot+"gen.json?s="+encodeForUrl(_lsa.a)+"&h="+encodeForUrl(window.location.href.split("//")[1].split("/")[0]),function(o){o.e&&null!==o.k&&validateLeadKey(o.k)&&(hit(o.k),processLsaMarketingCooke(e)),o.e===!1&&null===o.k&&docCookies.setItem("__lsanno",!0,21600,"/",null,null)})})}function processLsaMarketingCooke(e){if(e){Date.now||(Date.now=function(){return(new Date).getTime()});var o=docCookies.getItem("__lsm"),n=docCookies.getItem("__lsme");if(o)try{var t=o.match(/^\d+/);(!t||!t.length||Date.now()-t[0]>864e5)&&(o=null)}catch(e){}o||"false"===n||JSONP(urlApiRoot+"marketing.json?s="+encodeForUrl(_lsa.a)+"&h="+encodeForUrl(window.location.href.split("//")[1].split("/")[0])+"&k="+encodeForUrl(e),function(e){"e"in e&&(docCookies.setItem("__lsme",e.e===!0,3600,"/",null,null),e.e!==!0?docCookies.removeItem("__lsm","/"):"d"in e&&"string"==typeof e.d&&docCookies.setItem("__lsm",Date.now()+""+e.d,7776e3,"/",null,null))})}}var urlApiRoot="https://www.leadscoreapp.dk/lead_score/api/",docCookies={getItem:function(e){return e&&docCookies.hasItem(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},setItem:function(e,o,n,t,a,r){if(e&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(e)){var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toGMTString()}document.cookie=escape(e)+"="+escape(o)+c+(a?"; domain="+a:"")+(t?"; path="+t:"")+(r?"; secure":"")}},removeItem:function(e,o){e&&docCookies.hasItem(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; path="+o:""))},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=0;o<e.length;o++)e[o]=unescape(e[o]);return e}};!function(e,o){var n=function(n,t,a,r){n=n||"",t=t||{},a=a||"",r=r||function(){};var c=function(e){var o=[];for(var n in e)e.hasOwnProperty(n)&&o.push(n);return o};if("object"==typeof t){for(var i="",l=c(t),s=0;s<l.length;s++)i+=encodeURIComponent(l[s])+"="+encodeURIComponent(t[l[s]]),s!=l.length-1&&(i+="&");n+="?"+i}else"function"==typeof t&&(a=t,r=a);"function"==typeof a&&(r=a,a="callback"),Date.now||(Date.now=function(){return(new Date).getTime()});var d=Date.now(),u="jsonp"+Math.round(d+1000001*Math.random());e[u]=function(n){r(n);try{delete e[u]}catch(n){e[u]=o}},n+=n.indexOf("?")===-1?"?":"&";var p=document.createElement("script");p.setAttribute("src",n+a+"="+u),document.getElementsByTagName("head")[0].appendChild(p)};e.JSONP=n}(window),trackLeadScore(),"onhashchange"in window&&(window.onhashchange=trackLeadScore);